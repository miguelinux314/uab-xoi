\newpage
\section{Mission 6: Annoy two whole planets}\label{sec:mission6}

\begin{minipage}{0.73\linewidth}
Years have passed in the colony since you helped configure the large antenna that lets you communicate with Earth. Recently, your colony has found out about \textit{another} secret colony, this one on Saturn -- and Earth didn't even bother to tell us!\\

\noindent
The assembly has decided that a little prank is in order, and is asking for your help once again.
Your goal is to hijack the next Saturn $\leftrightarrow$ Earth TCP connection
and then send a forged memo impersonating Saturn. The assembly has requested that the memo be kept classy.
\end{minipage}
%
\hspace{0.03\linewidth}
%
\begin{minipage}{0.23\linewidth}
\includegraphics[width=\linewidth]{ostrich}
\end{minipage}

\subsection*{Report details}
\noindent
The colony's Chief Engineer has done some scouting work and is willing to help in your endeavor.
She has gathered the following pieces of information:

\begin{itemize}[itemsep=0.25cm]
\item Your HugeAntenna\texttrademark\ on the colony communicates with another HugeAntenna\texttrademark\ on Earth. Earth uses that same antenna to communicate with another HugeAntenna\texttrademark\ on Saturn.
When Earth receives the first packet of a TCP connection, they verify its origin.

\item After that first packet, Earth doesn't verify the origin of any packet. In fact, bogus or unexpected messages received after that one will be simply ignored, without triggering any alarm. With careful timing, you will use this to inject your forged packets.

\item The first day of each month at exactly 4:20 AM (Earth's New Barcelona time), Earth receives the first packet of a TCP connection from Saturn. These connections are used to exchange official memos, and the assembly wants you to hijack the next one.

\item Saturn uses an outdated, insecure TCP/IP stack with the following flaw: it always sets TCP's sequence number to $0$ in the first message of a TCP connection.

\item You won't be able to see the messages exchanged between Earth and Saturn. However, the Chief Engineer was able to capture the following Ethernet frame, which initiated the previous TCP connection (let's call it $C_{-1}$) between Saturn and Earth (\texttt{00 d0} is followed by \texttt{f1 bb} and \texttt{45 10} is followed by \texttt{00 28}):

\vspace{0.25cm}
\begin{center}
\begin{minipage}{0.5\linewidth}
\begin{verbatim}
00 09 bf 42 07 64 00 d0   f1 bb 0f 5a 08 00 45 10
00 28 d2 71 40 00 40 06   00 00 ca f7 44 05 4c 4c
15 15 9f ee 00 a9 00 00   00 00 00 00 00 00 50 02
01 00 00 00 00 00
\end{verbatim}
\end{minipage}
\end{center}
\vspace{0.25cm}
\end{itemize}

\noindent
With this in mind, the assembly has requested a report that contains the following aspects:

\begin{enumerate}[itemsep=0.25cm]
\item Draw a swimlane diagram depicting the establishment of the previous connection ($C_{-1}$) between Saturn and Earth.
Also, tabulate \textit{all} header fields present in these packets (and their values).

\item Explain your attack plan, \textit{i.e.}, how you plan to hijack the connection. Indicate clearly:
    \begin{itemize}
    \item What assumptions you are making about the next connection (e.g., what fields will remain identical or could change).
    \item How many messages you will be sending, and their planned timing.
    \end{itemize}

\item Show the full sequence of bytes of a frame that contains your prank memo.
\end{enumerate}

\subsection*{Feedback details}

Use a similar feedback process as in the previous missions, making sure to touch on the following key aspects:
\begin{itemize}
\item Was the frame captured by the Chief Engineer correctly decoded?
\item Were you able to concoct a plan that requires fewer messages?
\item Could you decode the prank memo? Was it classy?
\end{itemize}
